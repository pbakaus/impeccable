# 颜色和对比

## 颜色空间：使用OKLCH

**停止使用HSL。** 改为使用OKLCH（或LCH）。它是感知均匀的，意味着亮度中的相等步骤*看起来*相等——不像HSL，其中黄色50%亮度看起来亮而蓝色50%看起来暗。

```css
/* OKLCH: 亮度 (0-100%)，色度 (0-0.4+)，色调 (0-360) */
--color-primary: oklch(60% 0.15 250);      /* 蓝色 */
--color-primary-light: oklch(85% 0.08 250); /* 相同色调，更亮 */
--color-primary-dark: oklch(35% 0.12 250);  /* 相同色调，更暗 */
```

**关键洞察**：当你朝向白色或黑色移动时，减少色度（饱和度）。极端亮度的高色度看起来俗艳。85%亮度的浅蓝色需要~0.08色度，不是你的基色0.15。

## 构建功能调色板

### 着色中性陷阱

**纯灰色死了。** 给所有中性添加你的品牌色调的微妙暗示：

```css
/* 死灰色 */
--gray-100: oklch(95% 0 0);     /* 无个性 */
--gray-900: oklch(15% 0 0);

/* 暖着色灰色（添加品牌温暖） */
--gray-100: oklch(95% 0.01 60);  /* 温暖暗示 */
--gray-900: oklch(15% 0.01 60);

/* 凉着色灰色（科技，专业） */
--gray-100: oklch(95% 0.01 250); /* 蓝色暗示 */
--gray-900: oklch(15% 0.01 250);
```

色度很小（0.01）但可感知。它在你的品牌颜色和UI之间创造下意识凝聚。

### 调色板结构

完整系统需要：

| 角色 | 目的 | 示例 |
|------|----|------|
| **主要** | 品牌，CTA，关键行动 | 1颜色，3-5阴影 |
| **中性** | 文本，背景，边框 | 9-11阴影规模 |
| **语义** | 成功，错误，警告，信息 | 4颜色，每种2-3阴影 |
| **表面** | 卡片，模态，覆盖 | 2-3高度级别 |

**除非你需要，否则跳过次要/三级。** 大多数应用用一种强调颜色工作良好。添加更多创造决定疲劳和视觉噪音。

### 60-30-10规则（正确应用）

这个规则关于**视觉权重**，不是像素计数：

- **60%**：中性背景，空白，基表面
- **30%**：次要颜色——文本，边框，非活跃状态
- **10%**：强调——CTA，高亮，焦点状态

常见错误：因为它是"品牌颜色"而到处使用强调颜色。强调颜色有效*因为*它们稀有。过度使用杀死它们的力量。

## 对比和可访问性

### WCAG要求

| 内容类型 | AA最小 | AAA目标 |
|----------|--------|--------|
| 正文 | 4.5:1 | 7:1 |
| 大文本（18px+或14px粗体） | 3:1 | 4.5:1 |
| UI组件，图标 | 3:1 | 4.5:1 |
| 非必需装饰 | 无 | 无 |

**陷阱**：占位符文本仍然需要4.5:1。你到处看到的浅灰占位符？通常失败WCAG。

### 危险颜色组合

这些通常失败对比或引起可读性问题：

- 白上的浅灰文本（#1可访问性失败）
- **任何彩色背景上的灰色文本**——灰色在颜色上看起来洗淡和死。使用背景颜色的更暗阴影，或透明度
- 绿背景上的红色文本（或反之）——8%男性不能区分这些
- 红背景上的蓝色文本（视觉振动）
- 白上的黄色文本（几乎总是失败）
- 图像上的薄浅文本（不可预测对比）

### 绝不使用纯灰或纯黑

纯灰（`oklch(50% 0 0)`）和纯黑（`#000`）不存在于自然——真实阴影和表面总是有色调。即使0.005-0.01色度足以感觉自然而不明显着色。（见上面着色中性示例。）

### 测试

不要相信你的眼睛。使用工具：

- [WebAIM Contrast Checker](https://webaim.org/resources/contrastchecker/)
- 浏览器DevTools → Rendering → Emulate vision deficiencies
- [Polypane](https://polypane.app/) 实时测试

## 主题：浅色和暗色模式

### 暗色模式不是反转浅色模式

你不能只是交换颜色。暗色模式需要不同设计决定：

| 浅色模式 | 暗色模式 |
|----------|----------|
| 阴影获得深度 | 更浅表面获得深度（无阴影） |
| 浅上暗文本 | 暗上浅文本（减少字体权重） |
| 生动强调 | 稍微去饱和强调 |
| 白背景 | 绝不纯黑——使用暗灰（oklch 12-18%） |

```css
/* 通过表面颜色暗色模式深度，不是阴影 */
:root[data-theme="dark"] {
  --surface-1: oklch(15% 0.01 250);
  --surface-2: oklch(20% 0.01 250);  /* "更高" = 更浅 */
  --surface-3: oklch(25% 0.01 250);

  /* 稍微减少文本权重 */
  --body-weight: 350;  /* 而不是400 */
}
```

### 令牌层次

使用两层：原始令牌（`--blue-500`）和语义令牌（`--color-primary: var(--blue-500)`）。对于暗色模式，只重新定义语义层——原语保持相同。

## Alpha是设计气味

透明度（rgba，hsla）重使用通常意味着不完整调色板。Alpha创造不可预测对比，性能开销和不一致。为每个上下文定义明确覆盖颜色代替。例外：焦点环和需要透明的交互状态。

---

**避免**：仅依赖颜色传达信息。创建没有每个颜色清晰角色的调色板。对大区域使用纯黑（#000）。跳过色盲测试（8%男性受影响）。