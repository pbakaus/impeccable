# 交互设计

## 八个交互状态

每个交互元素需要这些状态设计：

| 状态 | 何时 | 视觉处理 |
|------|----|----------|
| **默认** | 休息中 | 基样式 |
| **悬停** | 指针悬停（不是触摸） | 微妙抬起，颜色变化 |
| **焦点** | 键盘/程序焦点 | 可见环（见下面） |
| **活跃** | 被按下 | 按入，更暗 |
| **禁用** | 非交互 | 减少不透明度，无指针 |
| **加载** | 处理中 | 旋转器，骨架 |
| **错误** | 无效状态 | 红边框，图标，消息 |
| **成功** | 完成 | 绿勾选，确认 |

**常见错过**：设计悬停而不焦点，或反之。它们不同。键盘用户从未见悬停状态。

## 焦点环：正确做

**绝不 `outline: none` 无替换。** 它是可访问性违规。改为使用 `:focus-visible` 仅对键盘用户显示焦点：

```css
/* 对鼠标/触摸隐藏焦点环 */
button:focus {
  outline: none;
}

/* 对键盘显示焦点环 */
button:focus-visible {
  outline: 2px solid var(--color-accent);
  outline-offset: 2px;
}
```

**焦点环设计**：
- 高对比（对相邻颜色至少3:1）
- 2-3px厚
- 从元素偏移（不在其内）
- 在所有交互元素一致

## 表单设计：非明显

**占位符不是标签**——它们在输入时消失。始终使用可见 `<label>` 元素。**在模糊时验证**，不是每击键（例外：密码强度）。用 `aria-describedby` 连接它们，将错误**放在**字段下面。

## 加载状态

**乐观更新**：立即显示成功，失败时回滚。对低风险行动使用（喜欢，跟随），不是支付或破坏行动。**骨架屏幕 > 旋转器**——它们预览内容形状并感觉更快于通用旋转器。

## 模态：惰性方法

模态中的焦点陷阱曾需要复杂JavaScript。现在使用 `inert` 属性：

```html
<!-- 当模态打开时 -->
<main inert>
  <!-- 模态背后的内容不能聚焦或点击 -->
</main>
<dialog open>
  <h2>模态标题</h2>
  <!-- 焦点留在模态内 -->
</dialog>
```

或使用原生 `<dialog>` 元素：

```javascript
const dialog = document.querySelector('dialog');
dialog.showModal();  // 用焦点陷阱打开，按Escape关闭
```

## 弹出框API

对工具提示、下拉和非模态覆盖，使用原生弹出框：

```html
<button popovertarget="menu">打开菜单</button>
<div id="menu" popover>
  <button>选项1</button>
  <button>选项2</button>
</div>
```

**益处**：轻关闭（点击外部关闭），适当堆叠，无z-index战争，默认可访问。

## 破坏行动：撤销 > 确认

**撤销比确认对话框更好**——用户盲目点击确认。从UI立即移除，显示撤销吐司，在吐司过期后实际删除。仅对真正不可逆行动（账户删除）、高成本行动或批量操作使用确认。

## 键盘导航模式

### 漫游Tabindex

对组件组（标签、菜单项、无线电组），一个项目是tabable；箭头键在其中移动：

```html
<div role="tablist">
  <button role="tab" tabindex="0">标签1</button>
  <button role="tab" tabindex="-1">标签2</button>
  <button role="tab" tabindex="-1">标签3</button>
</div>
```

箭头键在项目间移动 `tabindex="0"`。Tab完全移动到下一个组件。

### 跳过链接

为键盘用户提供跳过链接（`<a href="#main-content">跳到主内容</a>`）跳过导航。屏幕外隐藏，焦点时显示。

## 手势可发现性

滑动删除等手势是不可见的。暗示它们的存在：

- **部分揭示**：显示从边缘窥视的删除按钮
- **入职**：首次使用教练标记
- **替代**：始终提供可见回退（带"删除"的菜单）

不要依赖手势作为执行行动的唯一方式。

---

**避免**：移除焦点指示器而不替代。使用占位符文本作为标签。触摸目标<44x44px。通用错误消息。无ARIA/键盘支持的自定义控件。